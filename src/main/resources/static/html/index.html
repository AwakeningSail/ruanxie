<!doctype html>
<html class="x-admin-sm">

<head>
  <meta charset="UTF-8">
  <title>软协课程网站登录</title>
  <link rel="stylesheet" href="./css/font.css">
  <link rel="stylesheet" href="./css/login.css">
  <link rel="stylesheet" href="./css/xadmin.css">
  <script src="./lib/layui/layui.js" charset="utf-8"></script>
  <script src="./js/jquery-3.3.1.js" charset="utf-8"></script>
</head>

<body class="login-bg">

<div class="login layui-anim layui-anim-up">
  <div class="message">软协课程网站登录</div>
  <div id="darkbannerwrap"></div>

  <form method="post" class="layui-form">
    <input name="number" id="number" placeholder="用户名" type="text" lay-verify="required" class="layui-input">
    <hr class="hr15">
    <input name="password" id="password" placeholder="密码" type="password" lay-verify="required" class="layui-input">
    <hr class="hr15">
    <div class="layui-form-item">
      <label class="layui-form-label">登录类型:</label>
      <div class="layui-input-block">
        <input type="radio" name="type" value="0" title="管理员">
        <input type="radio" name="type" value="1" title="学生" checked>
        <input type="radio" name="type" value="2" title="老师" checked>
      </div>
    </div>
    <input value="登录" lay-submit lay-filter="login" style="width:100%;" type="submit">
    <hr class="hr20">
  </form>
</div>

<script>
  $(function () {
    layui.use('form', function () {
      var form = layui.form;
      form.render();
      form.on('submit(login)', function (data) {
        if ($('input:radio:checked').val() == 1) {
          $.ajax({
            url: 'http://localhost:8080/student/login',
            type: 'post',
            dataType: "json",
            data: JSON.stringify({
              id: $("#number").val(),
              password: $("#password").val()
            }),
            contentType: 'application/json',
            success: function (response) {
              console.log(response);
              if(response.status==1){
                layer.msg(response.object, { icon:1});
                location.href = 'main_student.html';
              }else{
                layer.msg(response.object, { icon: 5 });
              }
            },
            error: function (response) {

              console.log(response);
              layer.msg(response.responseText, { icon: 5 });
            }
          });
        } else {
          $.ajax({
            url: 'http://localhost:8080/teacher/login',
            type: 'post',
            data: {
              number: $("#number").val(),
              password: $("#password").val()
            },
            crossDomain: true,
            success: function (result) {
              a=$.parseJSON(result.responseText);
              console.log(a);
              if(a.status==1){
                layer.msg(a.object, { icon: 5 });
                location.href = 'html/MyTeam.html';
              }else{
                layer.msg(a.object, { icon: 5 });
              }
            },
            error: function () {
              layer.msg("服务器连接失败,稍后请重试", { icon: 5 });
            }
          });
        }

        return false;
      });
    });
  })
</script>
</body>
</html>